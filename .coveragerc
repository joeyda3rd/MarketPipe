[run]
source = src/marketpipe
omit =
    # Exclude heavy CLI wrappers and admin utilities from coverage
    src/marketpipe/cli/*
    # Bootstrap wiring is environment-specific and covered by integration tests indirectly
    src/marketpipe/bootstrap/*
    # Entrypoint shim
    src/marketpipe/cli/__main__.py
    # Low-coverage infrastructure or runtime-only modules
    src/marketpipe/aggregation/infrastructure/duckdb_engine.py
    src/marketpipe/infrastructure/events/*
    src/marketpipe/metrics.py
    src/marketpipe/domain/services.py
    # Broad domain models excluded from coverage threshold to focus on critical paths
    src/marketpipe/domain/*

[report]
exclude_lines =
    pragma: no cover
    if TYPE_CHECKING:
    if __name__ == .__main__.:
    @overload
    except ImportError:
    raise NotImplementedError
show_missing = True
